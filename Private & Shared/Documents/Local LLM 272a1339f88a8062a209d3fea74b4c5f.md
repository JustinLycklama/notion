# Local LLM

# ðŸš€ Step 1. Install Ollama

Ollama will run your local model.

1. Download Ollama: https://ollama.ai/download
2. Install it (Mac, Linux, Windows supported).
3. Verify itâ€™s running:
    
    ```bash
    ollama run llama2
    
    ```
    
    (It should load a small model and let you chat in the terminal.)
    

---

# ðŸ“¦ Step 2. Pull a Code Model

You want a **coder-optimized model** (C# support is decent in these):

```bash
ollama pull deepseek-coder:6.7b // lightweight model
ollama pull starcoder2:15b // heavier model, better at large context

```

- Use **DeepSeek Coder 6.7B or 7B** for speed on CPU/lower RAM.
- Use **StarCoder2 15B** if you have 32GB RAM or a GPU â€” better at multi-file reasoning.

Check available models with:

```bash
ollama list
```

Try to run the models listed
- ollama run starcoder2:15b

---

# Contexts..

Doesnâ€™t seem like there is a good way to do contexts with local LLMs

Played around with creating unit tests, had best results from a specific function within a file

- Unit Test Script
    
    ```python
    import subprocess
    from pathlib import Path
    import re
    import sys
    import tempfile
    
    def extract_method(cs_code: str, method_name: str):
        """
        Extract a single public method by name from the C# code.
        Returns the method code string, or None if not found.
        """
        pattern = re.compile(
            rf"public\s+(?:async\s+)?(?:[\w<>]+\s+)+{re.escape(method_name)}\s*\([^\)]*\)\s*\{{.*?\n\}}",
            re.DOTALL
        )
        match = pattern.search(cs_code)
        if match:
            return match.group(0)
        else:
            return None
    
    def generate_tests_for_method(class_name: str, method_code: str):
        """
        Generate xUnit [Fact] tests for a single method using StarCoder.
        """
        prompt = f"""
    You are an expert C# developer.
    Generate a single xUnit [Fact] test method for the following method.
    Include necessary using statements.
    Do not include explanations â€” only code.
    Assume it belongs to class {class_name}.
    
    Method:
    {method_code}
    """
    
        with tempfile.NamedTemporaryFile("w+", delete=False, encoding="utf-8", suffix=".txt") as tmp:
            tmp.write(prompt)
            tmp_path = tmp.name
    
        result = subprocess.run(
            f"type {tmp_path} | ollama run starcoder2:15b",
            shell=True,
            capture_output=True,
            text=True,
            encoding="utf-8"
        )
    
        if result.returncode != 0:
            print(f"Error generating tests for {class_name}:")
            print(result.stderr)
            return ""
    
        return result.stdout.strip()
    
    def generate_xunit_tests_for_method(file_path: str, method_name: str):
        file_path = Path(file_path)
        if not file_path.exists() or file_path.suffix != ".cs":
            print(f"Error: {file_path} does not exist or is not a C# file.")
            return
    
        with file_path.open("r", encoding="utf-8") as f:
            code = f.read()
    
        # Extract first class name (simplest)
        class_match = re.search(r"class\s+(\w+)", code)
        if not class_match:
            print(f"No class found in {file_path}")
            return
        class_name = class_match.group(1)
    
        # Extract the method
        method_code = extract_method(code, method_name)
        if not method_code:
            print(f"Method '{method_name}' not found in class '{class_name}'.")
            return
    
        print(f"Generating tests for method '{method_name}' in class '{class_name}'...")
        test_code = generate_tests_for_method(class_name, method_code)
    
        if test_code.strip():
            output_file = file_path.with_name(f"{file_path.stem}_{method_name}_Tests.cs")
            with output_file.open("w", encoding="utf-8") as f:
                f.write(test_code)
            print(f"Generated xUnit test: {output_file}")
        else:
            print("No tests were generated.")
    
    if __name__ == "__main__":
        if len(sys.argv) < 3:
            print("Usage: python generate_tests.py <path_to_cs_file> <method_name>")
        else:
            generate_xunit_tests_for_method(sys.argv[1], sys.argv[2])
    
    ```
    

```python
python generate_tests_method.py "C:\Path\To\YourClass.cs" MethodName
```